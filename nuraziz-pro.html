<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Athletic Coach</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>ðŸ’ª</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); min-height: 100vh; color: #333; }
        .hidden { display: none !important; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.2s; }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-primary:hover { background: #2563eb; }
        .btn-secondary { background: #e5e7eb; color: #374151; margin-top: 10px; }
        .input { width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; margin-bottom: 12px; font-size: 14px; }
        .input:focus { outline: none; border-color: #3b82f6; }
        .error { color: #dc2626; font-size: 12px; margin-top: 8px; display: none; }
        .error.show { display: block; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .header h1 { font-size: 24px; color: #1f2937; }
        .logout-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
        .session-card { color: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .session-card.morning { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .session-card.evening { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .session-card h2 { font-size: 20px; margin-bottom: 15px; }
        .session-stats { display: flex; justify-content: space-between; }
        .stat { text-align: center; }
        .stat-value { font-size: 32px; font-weight: bold; }
        .stat-label { font-size: 12px; opacity: 0.9; }
        .exercise-item { background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; border-left: 4px solid #3b82f6; }
        .exercise-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px; }
        .exercise-name { font-weight: bold; color: #1f2937; }
        .exercise-reps { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; }
        .status-completed { background: #d1fae5; color: #065f46; }
        .status-partial { background: #fef3c7; color: #92400e; }
        .status-missed { background: #fee2e2; color: #991b1b; }
        .delete-btn { background: none; border: none; color: #dc2626; cursor: pointer; font-size: 14px; margin-top: 8px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
        @media (max-width: 640px) { .grid { grid-template-columns: 1fr; } }
        .text-gray { color: #6b7280; }
        .mt-8 { margin-top: 32px; }
        .text-center { text-align: center; }
        #login-screen { display: flex; align-items: center; justify-content: center; min-height: 100vh; }
    </style>
</head>
<body>
    <!-- LOGIN -->
    <div id="login-screen">
        <div class="container" style="margin-top: 60px;">
            <div class="card" style="text-align: center;">
                <div style="font-size: 48px; margin-bottom: 16px;"><i class="fas fa-dumbbell"></i></div>
                <h1 style="font-size: 28px; margin-bottom: 8px;">Athletic Coach</h1>
                <p class="text-gray" style="margin-bottom: 32px;">Performance Tracker</p>

                <div id="login-form">
                    <input type="tel" id="phone" placeholder="Telefon: +998 90 123 45 67" class="input" oninput="formatPhone(this)">
                    <input type="password" id="pass" placeholder="Kod: 1234" class="input" onkeypress="if(event.key==='Enter') login()">
                    <button onclick="login()" class="btn btn-primary"><i class="fas fa-sign-in-alt"></i> Kirish</button>
                    <div id="error" class="error"></div>
                    <button onclick="showRegister()" class="btn btn-secondary"><i class="fas fa-user-plus"></i> Yangi Akkaunt</button>

                    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                        <p class="text-gray" style="font-size: 12px; margin-bottom: 8px;">Demo:</p>
                        <p class="text-gray" style="font-size: 12px;"><i class="fas fa-phone"></i> +998 90 123 45 67 | <i class="fas fa-lock"></i> 1234</p>
                    </div>
                </div>

                <div id="register-form" class="hidden">
                    <h2 style="font-size: 20px; margin-bottom: 20px;"><i class="fas fa-user-check"></i> Yangi Akkaunt</h2>
                    <input type="tel" id="reg-phone" placeholder="Telefon: +998 90 123 45 67" class="input" oninput="formatPhone(this)">
                    <input type="password" id="reg-pass" placeholder="Kod (4-6 raqam)" class="input">
                    <input type="password" id="reg-pass2" placeholder="Tasdiqlang" class="input">
                    <div id="reg-error" class="error"></div>
                    <button onclick="registerUser()" class="btn btn-primary"><i class="fas fa-check"></i> Yaratish</button>
                    <button onclick="backToLogin()" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Orqaga</button>
                </div>
            </div>
        </div>
    </div>

    <!-- APP -->
    <div id="main-screen" class="hidden">
        <div class="container" style="padding-top: 20px;">
            <div class="header">
                <div>
                    <h1><i class="fas fa-chart-line"></i> Athletic Coach</h1>
                    <p class="text-gray" style="font-size: 12px; margin-top: 4px;"><i class="fas fa-user"></i> <span id="user-phone"></span></p>
                </div>
                <button onclick="logout()" class="logout-btn"><i class="fas fa-sign-out-alt"></i></button>
            </div>

            <div class="grid">
                <div class="session-card morning">
                    <h2><i class="fas fa-sun"></i> Ertalab</h2>
                    <div class="session-stats">
                        <div class="stat">
                            <div class="stat-value" id="morning-volume">0</div>
                            <div class="stat-label">Hajm</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="morning-completion">0%</div>
                            <div class="stat-label">Tugatish</div>
                        </div>
                    </div>
                </div>

                <div class="session-card evening">
                    <h2><i class="fas fa-moon"></i> Kechqurun</h2>
                    <div class="session-stats">
                        <div class="stat">
                            <div class="stat-value" id="evening-volume">0</div>
                            <div class="stat-label">Hajm</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="evening-completion">0%</div>
                            <div class="stat-label">Tugatish</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 style="font-size: 18px; margin-bottom: 16px;"><i class="fas fa-plus-circle"></i> Mashq Qo'shish</h2>
                <input type="text" id="exercise-name" placeholder="Mashq nomi" class="input">
                <input type="number" id="target-reps" placeholder="Maqsad takrorlanish" class="input" min="1">
                <input type="number" id="actual-reps" placeholder="Haqiqiy takrorlanish" class="input" min="0">
                <select id="exercise-status" class="input" style="margin-bottom: 16px;">
                    <option value="completed"><i class="fas fa-check-circle"></i> Bajarildi</option>
                    <option value="partial"><i class="fas fa-exclamation-circle"></i> Qisman</option>
                    <option value="missed"><i class="fas fa-times-circle"></i> Bajarilmadi</option>
                </select>
                <button onclick="addExercise()" class="btn btn-primary"><i class="fas fa-plus"></i> Mashq Qo'shish</button>
            </div>

            <div id="exercises-list" class="text-center text-gray mt-8">
                <p><i class="fas fa-inbox"></i> Mashqlar yo'q</p>
            </div>
        </div>
    </div>

    <script>
        const db = {
            get: () => JSON.parse(localStorage.getItem('ac_data') || '{}'),
            set: (d) => localStorage.setItem('ac_data', JSON.stringify(d)),
            user: () => localStorage.getItem('ac_user'),
            setUser: (u) => localStorage.setItem('ac_user', u),
            clear: () => localStorage.removeItem('ac_user')
        };

        function init() {
            const d = db.get();
            if (!d['+998 90 123 45 67']) {
                d['+998 90 123 45 67'] = { pass: '1234', ex: [] };
                db.set(d);
            }
        }

        function login() {
            const p = document.getElementById('phone').value.trim();
            const pw = document.getElementById('pass').value.trim();
            if (!p || !pw) { err('Hammasini to\'ldiring'); return; }
            const d = db.get();
            if (!d[p] || d[p].pass !== pw) { err('Noto\'g\'ri'); return; }
            db.setUser(p);
            show();
        }

        function showRegister() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.remove('hidden');
        }

        function backToLogin() {
            document.getElementById('register-form').classList.add('hidden');
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('reg-phone').value = '';
            document.getElementById('reg-pass').value = '';
            document.getElementById('reg-pass2').value = '';
            document.getElementById('reg-error').classList.remove('show');
        }

        function registerUser() {
            const p = document.getElementById('reg-phone').value.trim();
            const pw = document.getElementById('reg-pass').value.trim();
            const pw2 = document.getElementById('reg-pass2').value.trim();
            const e = document.getElementById('reg-error');
            
            if (!p || !pw || !pw2) { regErr('Hammasini to\'ldiring'); return; }
            if (pw.length < 4 || pw.length > 6) { regErr('Kod 4-6 raqam bo\'lishi kerak'); return; }
            if (pw !== pw2) { regErr('Kodlar mos emas'); return; }
            
            const d = db.get();
            if (d[p]) { regErr('Bu telefon allaqachon ro\'yxatdan o\'tgan'); return; }
            
            d[p] = { pass: pw, ex: [] };
            db.set(d);
            alert('âœ… Akkaunt yaratildi! Endi kiring.');
            backToLogin();
        }

        function regErr(m) {
            const e = document.getElementById('reg-error');
            e.innerText = m;
            e.classList.add('show');
            setTimeout(() => e.classList.remove('show'), 3000);
        }

        function formatPhone(input) {
            let val = input.value.replace(/\D/g, '');
            if (val.length > 12) val = val.slice(0, 12);
            
            let formatted = '';
            if (val.length > 0) formatted = '+' + val.slice(0, 3);
            if (val.length > 3) formatted += ' ' + val.slice(3, 5);
            if (val.length > 5) formatted += ' ' + val.slice(5, 8);
            if (val.length > 8) formatted += ' ' + val.slice(8, 10);
            if (val.length > 10) formatted += ' ' + val.slice(10, 12);
            
            input.value = formatted;
        }

        function logout() {
            if (confirm('Chiqish?')) { db.clear(); location.reload(); }
        }

        function addExercise() {
            const n = document.getElementById('exercise-name').value.trim();
            const t = document.getElementById('target-reps').value;
            const a = document.getElementById('actual-reps').value;
            const s = document.getElementById('exercise-status').value;
            if (!n || !t || !a) { alert('Hammasini to\'ldiring'); return; }
            const u = db.user();
            const d = db.get();
            d[u].ex.push({ id: Date.now(), name: n, target: parseInt(t), actual: parseInt(a), status: s, date: new Date().toISOString().split('T')[0] });
            db.set(d);
            document.getElementById('exercise-name').value = '';
            document.getElementById('target-reps').value = '';
            document.getElementById('actual-reps').value = '';
            update();
        }

        function deleteExercise(id) {
            if (confirm('O\'chirish?')) {
                const u = db.user();
                const d = db.get();
                d[u].ex = d[u].ex.filter(e => e.id !== id);
                db.set(d);
                update();
            }
        }

        function update() {
            const u = db.user();
            const d = db.get();
            const today = new Date().toISOString().split('T')[0];
            const ex = d[u].ex.filter(e => e.date === today);
            const mv = ex.reduce((s, e) => s + e.actual, 0);
            const c = ex.filter(e => e.status === 'completed').length;
            const comp = ex.length > 0 ? Math.round((c / ex.length) * 100) : 0;
            document.getElementById('morning-volume').innerText = mv;
            document.getElementById('morning-completion').innerText = comp + '%';
            const list = document.getElementById('exercises-list');
            if (ex.length === 0) { list.innerHTML = '<p class="text-gray">Mashqlar yo\'q</p>'; return; }
            list.innerHTML = ex.map(e => {
                const statusClass = e.status === 'completed' ? 'status-completed' : e.status === 'partial' ? 'status-partial' : 'status-missed';
                const statusIcon = e.status === 'completed' ? '<i class="fas fa-check-circle"></i>' : e.status === 'partial' ? '<i class="fas fa-exclamation-circle"></i>' : '<i class="fas fa-times-circle"></i>';
                const statusText = e.status === 'completed' ? 'Bajarildi' : e.status === 'partial' ? 'Qisman' : 'Bajarilmadi';
                return `<div class="exercise-item"><div class="exercise-header"><div><div class="exercise-name">${e.name}</div><div class="exercise-reps">${e.actual}/${e.target}</div></div><span class="status-badge ${statusClass}">${statusIcon} ${statusText}</span></div><button onclick="deleteExercise(${e.id})" class="delete-btn"><i class="fas fa-trash"></i></button></div>`;
            }).join('');
        }

        function show() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-screen').classList.remove('hidden');
            document.getElementById('user-phone').innerText = db.user();
            update();
        }

        function err(m) {
            const e = document.getElementById('error');
            e.innerText = m;
            e.classList.add('show');
            setTimeout(() => e.classList.remove('show'), 3000);
        }

        init();
        if (db.user()) show();
    </script>
</body>
</html>
