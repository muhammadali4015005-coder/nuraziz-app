# ‚úÖ HEADER OYLIK MA'LUMOTLARI - BAJARILDI

## O'ZGARISHLAR

### 1. Header Yangilandi
Header qismiga oylik ma'lumotlari qo'shildi:
- üìÖ Ro'yxatdan o'tgan sana
- ‚è∞ Oylik qancha kun qolgan
- ‚úèÔ∏è Tahrirlash tugmasi (faqat admin uchun)

### 2. Rang Kodlari
Qolgan kunlarga qarab rang o'zgaradi:
- üü¢ Yashil: 11+ kun qolgan
- üü° Sariq: 6-10 kun qolgan
- üî¥ Qizil: 1-5 kun qolgan yoki tugagan

### 3. Tahrirlash Funksiyasi
Admin oylikni tahrirlashi mumkin:
- "Tahrirlash" tugmasini bosish
- Necha kun qo'shishni kiritish
- Avtomatik saqlanadi

## KO'RINISH

### Yashil (11+ kun)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí™ NURAZIZ                                         ‚îÇ
‚îÇ üìÖ Ro'yxatdan o'tgan: 07.02.2026 | ‚è∞ Oylik: 25   ‚îÇ
‚îÇ kun qoldi | ‚úèÔ∏è Tahrirlash                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Sariq (6-10 kun)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí™ NURAZIZ                                         ‚îÇ
‚îÇ üìÖ Ro'yxatdan o'tgan: 07.02.2026 | ‚è∞ Oylik: 8    ‚îÇ
‚îÇ kun qoldi | ‚úèÔ∏è Tahrirlash                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Qizil (1-5 kun)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí™ NURAZIZ                                         ‚îÇ
‚îÇ üìÖ Ro'yxatdan o'tgan: 07.02.2026 | ‚è∞ Oylik: 3    ‚îÇ
‚îÇ kun qoldi | ‚úèÔ∏è Tahrirlash                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Tugagan
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí™ NURAZIZ                                         ‚îÇ
‚îÇ ‚ö†Ô∏è Oylik tugagan!                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## FUNKSIYALAR

### 1. updateSubscriptionInfo()
Header qismidagi oylik ma'lumotlarini yangilaydi:

```javascript
function updateSubscriptionInfo() {
    if (!userData || !userData.subscriptionExpiry) return;
    
    const now = new Date();
    const expiry = new Date(userData.subscriptionExpiry);
    const startDate = userData.subscriptionDate ? new Date(userData.subscriptionDate) : null;
    const daysLeft = Math.ceil((expiry - now) / (1000 * 60 * 60 * 24));
    
    const subscriptionInfoDiv = document.getElementById('subscription-info');
    
    // Format dates
    const formatDate = (date) => {
        const d = new Date(date);
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = d.getFullYear();
        return `${day}.${month}.${year}`;
    };
    
    let infoHTML = '';
    
    if (startDate) {
        infoHTML += `<i class="fas fa-calendar-check"></i> Ro'yxatdan o'tgan: ${formatDate(startDate)} | `;
    }
    
    if (daysLeft > 0) {
        const color = daysLeft <= 5 ? '#ff0055' : daysLeft <= 10 ? '#ffa500' : '#00ff88';
        infoHTML += `<span style="color: ${color};"><i class="fas fa-clock"></i> Oylik: ${daysLeft} kun qoldi</span>`;
        infoHTML += ` | <button onclick="editSubscription()" ...>Tahrirlash</button>`;
    } else {
        infoHTML += `<span style="color: #ff0055;"><i class="fas fa-exclamation-triangle"></i> Oylik tugagan!</span>`;
    }
    
    subscriptionInfoDiv.innerHTML = infoHTML;
}
```

### 2. editSubscription()
Admin oylikni tahrirlaydi:

```javascript
function editSubscription() {
    if (!isAdmin) {
        alert('Faqat admin tahrirlashi mumkin!');
        return;
    }
    
    const days = prompt('Necha kun qo\'shmoqchisiz?', '30');
    if (days && !isNaN(days)) {
        const daysNum = parseInt(days);
        const currentExpiry = userData.subscriptionExpiry ? new Date(userData.subscriptionExpiry) : new Date();
        const newExpiry = new Date(currentExpiry.getTime() + daysNum * 24 * 60 * 60 * 1000);
        
        userData.subscriptionExpiry = newExpiry;
        userData.subscriptionActive = true;
        
        saveUserData();
        updateSubscriptionInfo();
        alert(`‚úÖ Oylik ${daysNum} kun uzaytirildi!`);
    }
}
```

### 3. update()
Har safar ma'lumotlar yangilanganda chaqiriladi:

```javascript
function update() {
    if (!userData) return;
    
    const today = new Date().toISOString().split('T')[0];
    
    // Update subscription info in header
    updateSubscriptionInfo();
    
    // ... rest of the function
}
```

## MA'LUMOTLAR STRUKTURASI

### userData
```javascript
{
    name: "Nuraziz",
    phone: "998901234567",
    subscriptionDate: "2026-02-07T00:00:00.000Z",  // Ro'yxatdan o'tgan sana
    subscriptionExpiry: "2026-03-09T00:00:00.000Z", // Oylik tugash sanasi
    subscriptionActive: true,
    // ... other fields
}
```

## SANA FORMATI

### formatDate() Funksiyasi
```javascript
const formatDate = (date) => {
    const d = new Date(date);
    const day = String(d.getDate()).padStart(2, '0');
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const year = d.getFullYear();
    return `${day}.${month}.${year}`;
};
```

**Misol:**
- Input: `2026-02-07T00:00:00.000Z`
- Output: `07.02.2026`

## FOYDALANISH

### Oddiy Foydalanuvchi
1. Login qiling
2. Header qismida oylik ma'lumotlarini ko'ring
3. Qancha kun qolganini bilib oling
4. Tahrirlash tugmasi ko'rinmaydi

### Admin
1. Admin sifatida kirish
2. Header qismida oylik ma'lumotlarini ko'ring
3. "Tahrirlash" tugmasini bosing
4. Necha kun qo'shishni kiriting (masalan: 30)
5. OK bosing
6. Oylik avtomatik uzaytiriladi

## RANG KODLARI

### Qolgan Kunlar
```javascript
const color = daysLeft <= 5 ? '#ff0055' :    // Qizil: 1-5 kun
              daysLeft <= 10 ? '#ffa500' :   // Sariq: 6-10 kun
              '#00ff88';                      // Yashil: 11+ kun
```

### Ikonlar
- üìÖ `<i class="fas fa-calendar-check"></i>` - Ro'yxatdan o'tgan
- ‚è∞ `<i class="fas fa-clock"></i>` - Oylik
- ‚úèÔ∏è `<i class="fas fa-edit"></i>` - Tahrirlash
- ‚ö†Ô∏è `<i class="fas fa-exclamation-triangle"></i>` - Tugagan

## MONGODB SAQLASH

Barcha o'zgarishlar avtomatik MongoDB ga saqlanadi:

```javascript
async function saveUserData() {
    try {
        const response = await fetch('/api/save-user', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(userData)
        });
        
        const result = await response.json();
        
        if (result.success) {
            console.log('‚úÖ User data saved to MongoDB successfully');
            
            // Also save to LocalStorage as backup
            const localData = JSON.parse(localStorage.getItem('nuraziz_local_db') || '{}');
            localData[userData.phone] = userData;
            localStorage.setItem('nuraziz_local_db', JSON.stringify(localData));
            console.log('‚úÖ Backup saved to LocalStorage');
        }
    } catch (err) {
        console.error('‚ùå MongoDB error:', err);
        // Fallback to LocalStorage
        const localData = JSON.parse(localStorage.getItem('nuraziz_local_db') || '{}');
        localData[userData.phone] = userData;
        localStorage.setItem('nuraziz_local_db', JSON.stringify(localData));
        console.log('‚ö†Ô∏è MongoDB not available, saved to LocalStorage');
    }
}
```

## AFZALLIKLARI

### 1. Doimiy Ko'rinish ‚úÖ
- Har doim header qismida
- Har sahifada ko'rinadi
- Unutib qolish xavfi yo'q

### 2. Rang Kodlari ‚úÖ
- Tez aniqlash
- Vizual ogohlantirish
- Intuitiv

### 3. Oson Tahrirlash ‚úÖ
- Admin uchun qulay
- Bir bosishda
- Avtomatik saqlash

### 4. MongoDB Saqlash ‚úÖ
- Barcha o'zgarishlar saqlanadi
- LocalStorage backup
- Ma'lumotlar xavfsiz

## SINASH

1. Serverni ishga tushiring: `npm run dev`
2. Brauzerda **Ctrl+Shift+R** bosing
3. Login qiling
4. Header qismida oylik ma'lumotlarini ko'ring
5. Admin sifatida kirish (parol: 963)
6. "Tahrirlash" tugmasini bosing
7. Necha kun qo'shishni kiriting
8. OK bosing
9. Oylik uzaytirilganini ko'ring

## FAYL
- `nuraziz-pro.html` - asosiy fayl

## SERVER
- Port: 5002
- URL: http://localhost:5002
- Status: ‚úÖ Ishlamoqda (Process ID: 7)

## XULOSA

‚úÖ **Header qismiga oylik ma'lumotlari qo'shildi**
‚úÖ **Ro'yxatdan o'tgan sana ko'rsatiladi**
‚úÖ **Qolgan kunlar rang bilan**
‚úÖ **Admin tahrirlashi mumkin**
‚úÖ **MongoDB ga avtomatik saqlanadi**
‚úÖ **LocalStorage backup**
‚úÖ **Zamonaviy dizayn va ikonlar**
